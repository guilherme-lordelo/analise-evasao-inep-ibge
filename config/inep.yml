#---------------------------------------------------------------------
# Fórmulas configuráveis
#
# Uso de {p} e {n}:
#   - {p} = ano base
#   - {n} = ano seguinte
#
# Os placeholders são substituídos pelo Python.
# Exemplo:
#   formula_evasao: "1 - ((QT_MAT_TOTAL_{n} - QT_ING_TOTAL_{n}) / (QT_MAT_TOTAL_{p} - QT_CONC_TOTAL_{p}))"
#   Para 2022 e 2023 vira:
#   "1 - ((QT_MAT_TOTAL_2023 - QT_ING_TOTAL_2023) / (QT_MAT_TOTAL_2022 - QT_CONC_TOTAL_2022))"
#
# A expressão deve usar APENAS nomes de colunas reais das tabelas INEP incluídas nas variáveis selecionadas.
#---------------------------------------------------------------------

formulas:
  evasao_anual:
    descricao: "Evasão anual considerando todos os alunos"
    expressao: "1 - ((QT_MAT_TOTAL_{n} - QT_ING_TOTAL_{n}) / (QT_MAT_TOTAL_{p} - QT_CONC_TOTAL_{p}))"
    validacao:
      regras:
        - "QT_MAT_TOTAL_{p} >= minimo_m_prev"
        - "QT_MAT_TOTAL_{n} >= minimo_m_n"
        - "QT_ING_TOTAL_{n} >= minimo_i_n"
        - "QT_CONC_TOTAL_{p} >= minimo_c_prev"
        - "(QT_MAT_TOTAL_{n} - QT_ING_TOTAL_{n}) > 0"
        - "(QT_MAT_TOTAL_{p} - QT_CONC_TOTAL_{p}) > 0"
        - "(QT_MAT_TOTAL_{n} - QT_ING_TOTAL_{n}) <= (QT_MAT_TOTAL_{p} - QT_CONC_TOTAL_{p})"

  evasao_anual_financiados:
    descricao: "Evasão entre estudantes com financiamento"
    expressao: "1 - ((QT_MAT_FINANC_{n} - QT_ING_FINANC_{n}) / (QT_MAT_FINANC_{p} - QT_CONC_FINANC_{p}))"
    validacao:
      regras:
        - "QT_MAT_FINANC_{p} >= minimo_m_prev"
        - "QT_MAT_FINANC_{n} >= minimo_m_n"
        - "QT_ING_FINANC_{n} >= minimo_i_n"
        - "QT_CONC_FINANC_{p} >= minimo_c_prev"
        - "(QT_MAT_FINANC_{n} - QT_ING_FINANC_{n}) > 0"
        - "(QT_MAT_FINANC_{p} - QT_CONC_FINANC_{p}) > 0"
        - "(QT_MAT_FINANC_{n} - QT_ING_FINANC_{n}) <= (QT_MAT_FINANC_{p} - QT_CONC_FINANC_{p})"

  total_estudantes:
    descricao: "Soma total de estudantes"
    expressao: "QT_MAT_TOTAL_{p} + QT_ING_TOTAL_{n}"
    validacao:
      regras: []   # sem validação

validacao_limites:
  minimo_m_prev: 10
  minimo_m_n: 5
  minimo_i_n: 1
  minimo_c_prev: 1

#---------------------------------------------------------------------
# Período de análise
#---------------------------------------------------------------------

anos:
  inicio: 2020
  fim: 2024

#---------------------------------------------------------------------
# Configurações de extração de dados INEP
#---------------------------------------------------------------------

extracao:
  encoding: "latin1"
  sep: ";"
  chunksize: 100000

#---------------------------------------------------------------------
# Configurações de extração de dados INEP
#---------------------------------------------------------------------

saida:
  encoding: "utf-8"
  sep: ";"
  compress: false
  columns_order: []

#---------------------------------------------------------------------
# Definições de variáveis INEP com tipos
#---------------------------------------------------------------------

variaveis:

  temporais:
    NU_ANO_CENSO: "Ano de referência dos dados"

  categoricas:

    IN_CAPITAL:
      descricao: "Indicador se o município é capital"
      valores:
        0: "Não é capital"
        1: "É capital"

    TP_ORGANIZACAO_ACADEMICA:
      descricao: "Tipo de organização acadêmica"
      valores:
        1: "Universidade"
        2: "Centro Universitário"
        3: "Faculdade"
        4: "Instituto Federal"

    TP_REDE:
      descricao: "Tipo de rede"
      valores:
        1: "Pública"
        2: "Privada"

    TP_GRAU_ACADEMICO:
      descricao: "Tipo de grau acadêmico"
      valores:
        1: "Bacharelado"
        2: "Licenciatura"
        3: "Tecnológico"
        4: "Bacharelado e Licenciatura"

    TP_MODALIDADE_ENSINO:
      descricao: "Modalidade de ensino"
      valores:
        1: "Presencial"
        2: "Educação a Distância"

  quantitativas:
    QT_ING_TOTAL: "Alunos ingressantes"
    QT_ING_FEM: "Ingressantes do sexo feminino"
    QT_ING_MASC: "Ingressantes do sexo masculino"
    QT_MAT_TOTAL: "Alunos matriculados"
    QT_MAT_FEM: "Matriculados do sexo feminino"
    QT_MAT_MASC: "Matriculados do sexo masculino"
    QT_CONC_TOTAL: "Concluintes"
    QT_ING_FINANC: "Ingressantes com financiamento"
    QT_MAT_FINANC: "Matriculados com financiamento"
    QT_CONC_FINANC: "Concluintes com financiamento"
    QT_SIT_TRANCADA: "Matrícula trancada"
    QT_SIT_DESVINCULADO: "Desvinculados"
    QT_SIT_TRANSFERIDO: "Transferidos"
    QT_SIT_FALECIDO: "Falecidos"

# ----------------------------------------------
# Mapeamento de nomes divergentes encontrados em cabeçalhos do INEP
# ----------------------------------------------

mapeamento_colunas:
  QT_ING: QT_ING_TOTAL
  QT_MAT: QT_MAT_TOTAL
  QT_CONC: QT_CONC_TOTAL

# ----------------------------------------------
# Regras de limpeza e tratamento
# ----------------------------------------------

limpeza:
  comportamento_sem_municipio: "atribuir"  # "descartar" ou "atribuir"
  valor_padrao_sem_municipio:
    CO_MUNICIPIO: -1
    SG_UF: "ND"
    NO_MUNICIPIO: "SEM_MUNICIPIO"
